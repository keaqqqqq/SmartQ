@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager NavigationManager

<MudDrawer Open="@_drawerOpen" ClipMode="DrawerClipMode.Always" Elevation="1" Variant="@DrawerVariant.Mini" 
           DisableOverlay="true" OpenMiniOnHover="true">
    <MudDrawerHeader>
        <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.Center">
            <MudImage Src="/images/logo.png" Alt="SmartQ Logo" Width="40" Height="40" />
            <MudText Typo="Typo.h6" Class="mt-2 ">SmartQ</MudText>
        </MudStack>
    </MudDrawerHeader>
    
    <div style="display: flex; flex-direction: column; height: 100%;">
        <div style="flex-grow: 1; overflow-y: auto;" >
            <MudNavMenu class="mt-6">
                <MudText Typo="Typo.subtitle2" Color="Color.Dark" Class="mx-4 my-2">Main Menu</MudText>
                
                <MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Dashboard">
                    Dashboard
                </MudNavLink>
                
                <MudNavLink Href="/booking" Icon="@Icons.Material.Filled.CalendarToday">
                    Booking
                </MudNavLink>
                
                <MudNavLink Href="/customers" Icon="@Icons.Material.Filled.People">
                    Customers
                </MudNavLink>
                
                <MudNavLink Href="/staff" Icon="@Icons.Material.Filled.PersonOutline" 
                           Disabled="@(!_canAccessStaffModule)">
                    Staff
                </MudNavLink>
                
                <MudNavLink Href="/analytics" Icon="@Icons.Material.Filled.BarChart">
                    Analytics
                </MudNavLink>
                
                <MudNavLink Href="/outlets" Icon="@Icons.Material.Filled.Store">
                    Outlet
                </MudNavLink>
                
                <MudDivider Class="my-2" />
                
                <MudText Typo="Typo.subtitle2" Color="Color.Dark" Class="mx-4 my-2">Preferences</MudText>
                
                <MudNavLink Href="/settings" Icon="@Icons.Material.Filled.Settings">
                    Settings
                </MudNavLink>
            </MudNavMenu>
        </div>
        
        <div style="margin-top: auto;">
            <MudPaper Class="rounded-lg py-4 px-2 mx-7 mb-2" Style="background-color: #f5f5f5;">
                <MudStack AlignItems="AlignItems.Center" Spacing="1">
                    <MudAvatar Style="height: 80px; width: 80px; background-color: #aaf0d1;">
                        <MudImage Src="/images/profile.jpg" Alt="Profile" Class="rounded-circle" />
                    </MudAvatar>
                    <MudText Typo="Typo.h6" Align="Align.Center" Class="mt-2">Chu Kea Qiu</MudText>
                    <MudText Typo="Typo.subtitle2" Align="Align.Center" Color="Color.Dark">Admin</MudText>
                    <MudText Typo="Typo.caption" Align="Align.Center" Color="Color.Dark">Damansara Link</MudText>
                </MudStack>
            </MudPaper>
        </div>
    </div>
</MudDrawer>

@code {
    private bool _drawerOpen = true;
    private bool _canAccessStaffModule = true; // Hardcoded for now

    [Parameter]
    public EventCallback<bool> DrawerToggled { get; set; }

    public void ToggleDrawer()
    {
        _drawerOpen = !_drawerOpen;
        DrawerToggled.InvokeAsync(_drawerOpen);
    }
}